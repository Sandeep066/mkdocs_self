
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.0">
    
    
      
        <title>Non-Operator Installation - Watson Core | WML Serving</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.fe914879.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ba0d045b.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#prerequisites" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Watson Core | WML Serving" class="md-header__button md-logo" aria-label="Watson Core | WML Serving" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Watson Core | WML Serving
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Non-Operator Installation
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Watson Core | WML Serving" class="md-nav__button md-logo" aria-label="Watson Core | WML Serving" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Watson Core | WML Serving
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        Home
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Home" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="/" class="md-nav__link">
        Home
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Installation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installation" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="/install" class="md-nav__link">
        Getting started
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="/install/install" class="md-nav__link">
        Operator-based Installation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Deploying models as Predictors
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Deploying models as Predictors" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Deploying models as Predictors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="/predictors" class="md-nav__link">
        Summary
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup-the-etcd-connection-information" class="md-nav__link">
    Setup the etcd connection information
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    Next Steps
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Non-Operator Installation</h1>
                
                <h2 id="prerequisites">Prerequisites</h2>
<ul>
<li>
<p><strong>Kubernetes cluster</strong> - A Kubernetes cluster is required. You will need <code>cluster-admin</code> authority in order to complete all of the prescribed steps.</p>
</li>
<li>
<p>To set up WML Serving for local minikube, review the <a href="minikube">minikube instructions</a>.</p>
</li>
<li>
<p><strong>Kubectl and Kustomize</strong> - The installation will occur via the terminal using <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/">kubectl</a> and <a href="https://kubectl.docs.kubernetes.io/installation/kustomize/">kustomize</a>.</p>
</li>
<li>
<p><strong>etcd</strong> - WML Serving requires an <a href="https://etcd.io/">etcd</a> server in order to coordinate internal state which can be either dedicated or shared. More on this later.</p>
</li>
<li>
<p><strong>S3-compatible object storage</strong> - Before models can be deployed, a remote S3-compatible datastore is needed from which to pull the model data. This could be for example an <a href="https://www.ibm.com/cloud/object-storage">IBM Cloud Object Storage</a> instance, or a locally running <a href="https://github.com/minio/minio">MinIO</a> deployment. Note that this is not required to be in place prior to the initial installation.</p>
</li>
</ul>
<p>We provide an install script to quickly run WML Serving without the operator. This may be useful for experimentation or development but should not be used in production.</p>
<p>The install script has a <code>--quickstart</code> option for setting up a self-contained WML Serving instance. This will deploy and configure local etcd and MinIO servers in the same Kubernetes namespace. Note that this is only for experimentation and/or development use - in particular the connections to these datastores are not secure and the etcd cluster is a single member which is not highly available. Use of <code>--quickstart</code> also configures the <code>storage-config</code> secret to be able to pull from the <a href="../example-models">WML Serving example models bucket</a> which contains the model data for the sample Predictors. For complete details on the manfiests applied with <code>--quickstart</code> see <a href="https://github.ibm.com/ai-foundation/wml-serving/blob/main/config/install/dependencies/quickstart.yaml">config/dependencies/quickstart.yaml</a>.</p>
<h2 id="setup-the-etcd-connection-information">Setup the etcd connection information</h2>
<p>If the <code>--quickstart</code> install option is <strong>not</strong> being used, details of an existing etcd cluster must be specified prior to installation. Otherwise, please skip this step and proceed to <a href="#installation">Installation</a>.</p>
<p>Create a file named etcd-config.json, populating the values based upon your etcd server. The same etcd server can be shared between environments and/or namespaces, but in this case <em>the <code>root_prefix</code> must be set differently in each namespace's respective secret</em>. The complete json schema for this configuration is documented <a href="https://github.com/IBM/etcd-java/blob/master/etcd-json-schema.md">here</a>.</p>
<pre><code class="language-json">{
  &quot;endpoints&quot;: &quot;https://etcd-service-hostame:2379&quot;,
  &quot;userid&quot;: &quot;userid&quot;,
  &quot;password&quot;: &quot;password&quot;,
  &quot;root_prefix&quot;: &quot;unique-chroot-prefix&quot;
}
</code></pre>
<p>Then create the secret using the file (note that the key name within the secret must be <code>etcd_connection</code>):</p>
<pre><code class="language-shell">kubectl create secret generic model-serving-etcd --from-file=etcd_connection=etcd-config.json
</code></pre>
<p>A secret named <code>model-serving-etcd</code> will be created and passed to the controller.</p>
<h2 id="installation">Installation</h2>
<p>Download and extract the latest install script from Artifactory using the latest release from <a href="https://github.ibm.com/ai-foundation/wml-serving/releases">Github</a> (use your IBM credentials to log in):</p>
<pre><code class="language-shell">VERSION=0.4.2_106
DOWNLOAD_URL=https://na.artifactory.swg-devops.com/artifactory/wcp-ai-foundation-team-generic-virtual/model-serving/wml-serving-${VERSION}-install.sh

wget --user=you@us.ibm.com --ask-password ${DOWNLOAD_URL}

# If you don't have wget you can also use curl
curl -u ${artifactory_user}:${artifactory_apikey} -o wml-serving-install.sh ${DOWNLOAD_URL}
</code></pre>
<p>Run the downloaded script to install WML Serving CRDs, controller, and built-in runtimes into the specified Kubernetes namespaces, after reviewing the command line flags below.</p>
<p>An Artifactory user and API key are required to pull the WML Serving tar file and images. These can be passed in as flags or set as environment variables.</p>
<p>A Kubernetes <code>--namespace</code> is required, which must already exist. You must also have cluster-admin authority and cluster access must be configured prior to running the install script.</p>
<p>An Artifactory user and API key is required if you are pulling the WML Serving tar file and images. These can be passed in as flags or set as environment variables.</p>
<p>The <code>--quickstart</code> option can be specified to install and configure supporting datastores in the same namespace (etcd and MinIO) for experimental/development use. If this is not chosen, the namespace provided must have an Etcd secret named <code>model-serving-etcd</code> created which provides access to the Etcd cluster. See the <a href="#setup-the-etcd-connection-information">instructions above</a> on this step.</p>
<pre><code class="language-shell">$ ./wml-serving-install.sh --help
usage: ./wml-serving-install.sh [flags]

Flags:
  -n, --namespace                (required) Kubernetes namespace to deploy WML Serving to.
  -u, --artifactory-user         Artifactory username to pull WML serving tarfile and images, can also set with env var ARTIFACTORY_USER.
  -a, --artifactory-apikey       Artifactory API key to pull WML serving tarfile and images, can also set with env var ARTIFACTORY_APIKEY.
  -v, --model-serve-version      WML serving version to pull and use. Example: wml-serving-0.3.0_165
  -p, --install-config-path      Path to local model serve installation configs. Can be WML Serving tarfile or directory.
  -d, --delete                   Delete any existing instances of WML Serving in Kube namespace before running install, including CRDs, RBACs, controller, older CRD with ai.ibm.com api group name, etc.
  --quickstart                   Install and configure required supporting datastores in the same namespace (etcd and MinIO) - for experimentation/development
  --redsonja-images              Use images pulled from redsonja IBM Container registry, requires redsonja user and apikey.
  --redsonja-apikey              IBM container registry apikey that has access to redsonja account, can also set with env var REDSONJA_APIKEY.
</code></pre>
<p>As you can see, you can optionally provide an explicit <code>--model-serve-version</code> for the WML Serving tar file, which will be pulled down from Artifactory via the install script. If not provided, the version installed will be the one corresponding to the version of the install script. Alternatively, you can provide a local <code>--install-config-path</code> that points to a local WML Serving tar file or directory containing WML Serving configs to deploy.</p>
<p>You can also optionally use <code>--delete</code> to delete any existing instances of WML Serving in the designated Kube namespace before running the install.</p>
<p>The installation will create a secret named <code>storage-config</code> if it does not already exist. If the <code>--quickstart</code> option was chosen, this will be populated with the connection details for the example models bucket in IBM Cloud Object Storage and the local MinIO; otherwise, it will be empty and ready for you to add your own entries.</p>
<p>To deploy WML Serving with images from IBM Container Registry (ICR) instead of using the default Artifactory images, add flag <code>--redsonja-images</code>. Note that the Kube dockerconfig secret <code>ibm-entitlement-key</code> in the deployed namespace must have a username (likely <code>iamapikey</code>) and api key that has access to the <code>redsonja_hyboria/ai-foundation</code> namespace in the redsonja ICR account. If the Kube secret does not already exist, you can provide your <code>--redsonja-apikey &lt;APIKEY&gt;</code> and the secret will be created in the install script.</p>
<h2 id="next-steps">Next Steps</h2>
<ul>
<li>Continue with the "Deployed Components" section of the <a href="../install#deployed-components">Getting Started</a> page.</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.53c85856.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.716f8af4.min.js"></script>
      
    
  </body>
</html>